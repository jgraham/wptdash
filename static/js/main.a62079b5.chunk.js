(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){e.exports=n(25)},19:function(e,t,n){},23:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(12),o=n.n(s),i=(n(19),n(1)),c=n.n(i),l=n(4),u=n(8),h=n(2),p=n(6),f=n(3),d=n(5),v=n(10),m=n(7),b=(n(23),c.a.mark(k)),y=c.a.mark(w),g=c.a.mark(E);function k(e){var t;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t=e.length;case 1:if(!(t>0)){n.next=7;break}return t--,n.next=5,e[t];case 5:n.next=1;break;case 7:case"end":return n.stop()}},b,this)}function O(e,t){return e===t||!(!Array.isArray(e)||!Array.isArray(t))&&(e.length===t.length&&e.every(function(e,n){return e===t[n]}))}function j(e,t){if(e.size!==t.size)return!1;var n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var i=s.value;if(!t.has(i))return!1}}catch(c){a=!0,r=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return!0}function w(e,t){var n,a,r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(n=Array.from(e.keys())).sort(),a=0;case 3:if(!(a<n.length)){t.next=10;break}return r=n[a],t.next=7,[r,e.get(r)];case 7:a++,t.next=3;break;case 10:case"end":return t.stop()}},y,this)}function E(e){var t,n,a,r,s,o,i;return c.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:t=0,n=!0,a=!1,r=void 0,c.prev=4,s=e[Symbol.iterator]();case 6:if(n=(o=s.next()).done){c.next=14;break}return i=o.value,c.next=10,[t,i];case 10:t++;case 11:n=!0,c.next=6;break;case 14:c.next=20;break;case 16:c.prev=16,c.t0=c.catch(4),a=!0,r=c.t0;case 20:c.prev=20,c.prev=21,n||null==s.return||s.return();case 23:if(c.prev=23,!a){c.next=26;break}throw r;case 26:return c.finish(23);case 27:return c.finish(20);case 28:case"end":return c.stop()}},g,this,[[4,16,20,28],[21,,23,27]])}var C=c.a.mark(P),x=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),t}(Object(v.a)(Error)),S={and:function(e){if(!Array.isArray(e))throw new x("Argument to 'and' clause must be an array");var t=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var i=s.value;t.push(_(i))}}catch(c){a=!0,r=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return M.and.apply(M,t)},or:function(e){if(!Array.isArray(e))throw new x("Argument to 'or' clause must be an array");var t=[],n=!0,a=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var i=s.value;t.push(_(i))}}catch(c){a=!0,r=c}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}return M.or.apply(M,t)},"==":function(e){return M["=="](e)},not:function(e){var t=Object(m.a)(e,1)[0];return M.not(_(t))},in:function(e){return M.in(e)},has:function(e){var t=Object(m.a)(e,1)[0];if("string"!==typeof t)throw new x("Argument to 'has' clause must be a string");return M.has(t)}},M={and:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.every(function(t){return t(e)})}},or:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.some(function(t){return t(e)})}},"==":function(e){var t=Object(m.a)(e,2);return t[0]===t[1]},not:function(e){return function(t){return!e(t)}},in:function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];return function(e){var t=I(e,a);if("string"!==typeof t)throw new x;return t.includes(n)}},has:function(e){return function(t){return void 0!==I(t,e)}}};function I(e,t){var n=t.split("."),a=e,r=!0,s=!1,o=void 0;try{for(var i,c=n[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var l=i.value;if(void 0===(a=a instanceof Map?a.get(l):a[l]))return}}catch(u){s=!0,o=u}finally{try{r||null==c.return||c.return()}finally{if(s)throw o}}return a}function _(e){var t=Object.keys(e);if(1!==t.length)throw console.error(e),new x("Can't handle an input with multiple keys");var n=t[0];if(!S.hasOwnProperty(n))throw console.error(e),new x("Unknown operator ".concat(n));return S[n](e[n])}var D=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),t}(Object(v.a)(Error));function P(e){var t,n,a,r,s,o;return c.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=/\s*/,n=/\w(?:\w|\d|\.|_|-|\+|\/)*|\d+|==|!=|\(|\)|:|".*?[^\\]"|'.*?[^\\]'/,a=e.length;case 3:if(!e.length){i.next=19;break}if(!(r=e.match(t))[0].length){i.next=10;break}if(s=r[0].length,(e=e.slice(s)).length){i.next=10;break}return i.abrupt("break",19);case 10:if(r=e.match(n)){i.next=13;break}throw new D("Invalid input at character ".concat(a-e.length));case 13:return o=r[0],i.next=16,o;case 16:e=e.slice(o.length),i.next=3;break;case 19:case"end":return i.stop()}},C,this)}var A=new Set(["==","!=","in","and","or","!","not",":","has"]),T=new Set(["!","not","has"]),L=[[":"],["in","==","!=","has"],["not","!"],["and"],["or"]],N=new Map,R=!0,U=!1,z=void 0;try{for(var F,G=L.map(function(e,t){return[t,e]})[Symbol.iterator]();!(R=(F=G.next()).done);R=!0){var B=F.value,W=Object(m.a)(B,2),$=W[0],q=W[1],H=!0,V=!1,J=void 0;try{for(var Q,K=q[Symbol.iterator]();!(H=(Q=K.next()).done);H=!0){var X=Q.value;N.set(X,L.length-$)}}catch(Ye){V=!0,J=Ye}finally{try{H||null==K.return||K.return()}finally{if(V)throw J}}}}catch(Ye){U=!0,z=Ye}finally{try{R||null==G.return||G.return()}finally{if(U)throw z}}var Y=new Map(Object.entries({"!":"not"})),Z=new Map(Object.entries({test:"in"})),ee=function(){function e(t){Object(h.a)(this,e),this.name=t}return Object(l.a)(e,[{key:"to_object",value:function(){var e={};return e[this.name]=this.children().map(function(e){return e.to_object()}),e}}]),e}(),te=function(e){function t(e){var n;if(Object(h.a)(this,t),!A.has(e)||!T.has(e))throw new Error;return Y.has(e)&&(e=Y.get(e)),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).operand=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"children",value:function(){return[this.operand]}}]),t}(ee),ne=function(e){function t(e){var n;if(Object(h.a)(this,t),!A.has(e)||T.has(e))throw new Error;return Y.has(e)&&(e=Y.get(e)),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).lhs=null,n.rhs=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"children",value:function(){return[this.lhs,this.rhs]}}]),t}(ee),ae=function(e){function t(e){return Object(h.a)(this,t),"'"!==e[0]&&'"'!==e[0]||(e=e.slice(1,e.length-1)),Object(p.a)(this,Object(f.a)(t).call(this,e))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"to_object",value:function(){return this.name}}]),t}(ee);function re(e){return T.has(e)?new te(e):new ne(e)}var se=function(){function e(){Object(h.a)(this,e),this.operators=[],this.operands=[]}return Object(l.a)(e,[{key:"top",value:function(){return this.operators.length?this.operators[this.operators.length-1]:null}},{key:"parse",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;if("("===o)this.operators.push(o);else if(")"===o){for(;null!==this.top()&&"("!==this.top();)this.apply();if(!this.operators.length)throw new D("Mismatched parens");this.operators.pop()}else if(A.has(o)){for(;null!==this.top()&&")"!==this.top()&&this.precedence(this.top().name)>=this.precedence(o);)this.apply();this.operators.push(re(o))}else this.operands.push(new ae(o))}}catch(Ye){n=!0,a=Ye}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}for(;this.operators.length;)this.apply();if(1!==this.operands.length)throw new D("Operands remaining at end of input");return this.operands[0]}},{key:"precedence",value:function(e){return N.get(e)}},{key:"apply",value:function(){var e=this.operators.pop();if(T.has(e.name)){var t=this.operands.pop();if(!t)throw new Error;e.operand=t}else{var n=this.operands.pop(),a=this.operands.pop();if(!a||!n)throw new Error;e.lhs=a,e.rhs=n,":"===e.name&&(e=function(e){var t="==";if(Z.has(e.lhs.name)&&(t=Z.get(e.lhs.name)),e.name=t,"in"===t){var n=[e.rhs,e.lhs];e.lhs=n[0],e.rhs=n[1]}return e}(e))}this.operands.push(e)}}]),e}();function oe(e){return(new se).parse(P(e)).to_object()}var ie=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleChange=function(e){n.setState({checked:!!e.target.checked}),n.props.onCheckboxChange(n.props.value,e.target.checked)},n.state={checked:n.props.checked},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("input",{name:this.props.name,type:"checkbox",checked:this.state.checked,onChange:this.handleChange})}}]),t}(a.Component),ce=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=e.target.value;n.props.onChange(t)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("input",{name:this.props.name,onChange:this.handleChange,defaultValue:this.props.defaultValue,list:this.props.list})}}]),t}(a.Component),le=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.onChange(e.target.value)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.options.map(function(e){return r.a.createElement("option",{value:e.value,key:e.value},e.name)});return r.a.createElement("select",{onChange:this.handleChange,value:this.props.value},e)}}]),t}(a.Component),ue=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=e.target.selectedOptions;n.props.onChange([].map.call(t,function(e){return e.value}))},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.options.map(function(e){return r.a.createElement("option",{value:e.value,key:e.value,selected:e.selected},e.name)});return r.a.createElement("select",{size:"3",multiple:!0,onChange:this.handleChange},e)}}]),t}(a.Component),he=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleChange=function(e,t){var a=new Map(n.state.selected.entries());a.set(e,t),n.setState({selected:a}),n.props.onChange(Array.from(a.entries()))},n.state={selected:new Map},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(this.props!==e){var n=new Map(this.props.options.map(function(e){return[e.name,e.selected]}));this.setState({selected:n})}}},{key:"render",value:function(){var e=this;return this.props.options.map(function(t){return r.a.createElement("label",null,r.a.createElement(ie,{name:t.value,key:t.value,checked:t.selected,onCheckboxChange:e.handleChange}),t.value)})}}]),t}(a.Component),pe=(a.Component,"https://queue.taskcluster.net/v1/task"),fe="https://wpt.fyi",de=new Set(["PASS","OK"]),ve=["chrome","firefox","safari"],me=Object.freeze({NONE:0,LOADING:1,COMPLETE:2});function be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new URL("".concat(fe,"/").concat(e)),a=[["label","master"],["product","chrome[experimental]"],["product","firefox[experimental]"],["product","safari[experimental]"]];t=new Map(Object.entries(t));for(var r=0;r<a.length;r++){var s=a[r],o=Object(m.a)(s,2),i=o[0],c=o[1];t.has(i)||n.searchParams.append(i,c)}var l=!0,u=!1,h=void 0;try{for(var p,f=function(){var e=p.value,t=(v=Object(m.a)(e,2))[0],a=v[1];if(null===a||void 0===a)return"continue";Array.isArray(a)?a.forEach(function(e){return n.searchParams.append(t,e)}):n.searchParams.append(t,a)},d=t[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var v;f()}}catch(Ye){u=!0,h=Ye}finally{try{l||null==d.return||d.return()}finally{if(u)throw h}}return n}function ye(e){return e&&e[0].toUpperCase()+e.slice(1)}var ge=function(e){function t(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(h.a)(this,t),a||(a="Fetch for ".concat(e.url," returned status ").concat(e.status," ").concat(e.statusText)),(n=Object(p.a)(this,Object(f.a)(t).call(this,a))).resp=e,n.name="FetchError",n}return Object(d.a)(t,e),t}(Object(v.a)(Error));function ke(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(u.a)(c.a.mark(function e(t,n){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,n);case 2:if((a=e.sent).ok){e.next=5;break}throw new ge(a);case 5:return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var je=/^(.*\.any)(:?\..*)\.html$/,we=/^(.*\.(:?worker|window))\.html$/;function Ee(e){var t=new URL("https://web-platform.test".concat(e)).pathname,n=je.exec(t);return null===n&&(n=we.exec(t)),null!==n&&(t=n[1]+".js"),t}var Ce=new(function(){function e(){Object(h.a)(this,e),this.url=new URL(window.location),this.params=this.url.searchParams}return Object(l.a)(e,[{key:"_update",value:function(){window.history.replaceState({},document.title,this.url.href)}},{key:"get",value:function(e){return this.params.get(e)}},{key:"has",value:function(e){return this.params.has(e)}},{key:"set",value:function(e,t){this.params.set(e,t),this._update()}},{key:"delete",value:function(e){this.params.delete(e),this._update()}},{key:"append",value:function(e,t){this.params.append(e,t),this._update()}}]),e}()),xe=function(){var e=-1;return function(t,n){return{id:++e,err:t,options:n}}}(),Se=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=xe(e,t);n.setState(function(e){return{errors:e.errors.concat(a)}})},n.onDismissError=function(e){var t=Array.from(n.state.errors),a=t.findIndex(function(t){return t.id===e});void 0!==a&&(t.splice(a,1),n.setState({errors:t}))},n.onFilterChange=function(e){n.setState({filterFunc:e})},n.onRunChange=function(e){n.setState({runSha:e})},n.onComponentChange=function(e){var t=e.toLowerCase(),a=new Set(n.state.bugComponentsMap.get(t));Ce.set("bugComponent",e),Ce.delete("paths"),n.setState({currentBugComponent:t,selectedPaths:a})},n.onPathsChange=function(e){var t=Array.from(e);t.sort(),O(t,n.state.bugComponentsMap.get(n.state.currentBugComponent))?Ce.delete("paths"):Ce.set("paths",t.join(",")),n.setState({selectedPaths:e})},n.state={bugComponents:[],bugComponentsMap:new Map,currentBugComponent:null,selectedPaths:new Set,runSha:null,wptRuns:null,geckoMetadata:{},geckoMetadataForPaths:{},errors:[],loading_state:me.NONE,filter:null,filterFunc:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"fetchData",value:function(){var e=Object(u.a)(c.a.mark(function e(t,n){var a,r=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=r.length>2&&void 0!==r[2]?r[2]:{}).hasOwnProperty("redirect")||(a.redirect="follow"),e.prev=2,e.next=5,ke(t,a);case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),this.onError(e.t0,{retry:n}),e.t0;case 12:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadTaskClusterData",value:function(){var e=Object(u.a)(c.a.mark(function e(t,n){var a,r,s,o,i,l,h,p,f,d,v,m,b,y=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.loadTaskClusterData(t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),e.next=3,this.fetchData("".concat("https://index.taskcluster.net/v1/task","/").concat(t),a);case 3:return r=e.sent,s=r.taskId,e.next=7,this.fetchData("".concat(pe,"/").concat(s,"/status"),a);case 7:o=e.sent,l=!0,h=!1,p=void 0,e.prev=11,f=k(o.status.runs)[Symbol.iterator]();case 13:if(l=(d=f.next()).done){e.next=21;break}if("completed"!==(v=d.value).state){e.next=18;break}return i=v.runId,e.abrupt("break",21);case 18:l=!0,e.next=13;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(11),h=!0,p=e.t0;case 27:e.prev=27,e.prev=28,l||null==f.return||f.return();case 30:if(e.prev=30,!h){e.next=33;break}throw p;case 33:return e.finish(30);case 34:return e.finish(27);case 35:return e.next=37,this.fetchData("".concat(pe,"/").concat(s,"/runs/").concat(i,"/artifacts"),a);case 37:return m=e.sent,b=m.artifacts.find(function(e){return e.name.endsWith(n)}),e.abrupt("return",this.fetchData("".concat(pe,"/").concat(s,"/runs/").concat(i,"/artifacts/").concat(b.name),a));case 40:case"end":return e.stop()}},e,this,[[11,23,27,35],[28,,30,34]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadBugComponentData",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,r,s,o,i,l,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadTaskClusterData("gecko.v2.mozilla-central.latest.source.source-bugzilla-info","components-normalized.json");case 2:t=e.sent,n=this.processComponentData(t),a=Object(m.a)(n,2),r=a[0],s=a[1],(r=Array.from(r).sort()).push("Any"),this.setState({bugComponentsMap:s,bugComponents:r}),!(o=this.state.currentBugComponent)&&Ce.has("bugComponent")&&(i=Ce.get("bugComponent"),s.has(i)&&(o=i)),o||(o=r[0].toLowerCase()),l=new Set(s.get(o)),Ce.has("paths")&&(u=new Set(Ce.get("paths").split(",")),l=new Set(Array.from(l).filter(function(e){return u.has(e)}))),this.setState({selectedPaths:l,currentBugComponent:o});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadWptRunData",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,r,s=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={aligned:""},this.state.runSha&&(t.sha=this.state.runSha),n=be("api/runs",t),e.next=5,this.fetchData(n,Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.loadWptRunData());case 1:case"end":return e.stop()}},e,this)})));case 5:a=e.sent,r=a[0].full_revision_hash,this.setState({wptRuns:a,runSha:r});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadGeckoMetadata",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadTaskClusterData("gecko.v2.mozilla-central.latest.source.source-wpt-metadata-summary","summary.json");case 2:t=e.sent,this.setState({geckoMetadata:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading_state:me.LOADING}),t=this.loadBugComponentData(),n=this.loadWptRunData(),a=this.loadGeckoMetadata(),e.next=6,Promise.all([t,n,a]);case 6:this.setState({loading_state:me.COMPLETE});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"filterGeckoMetadata",value:function(){if(this.state.selectedPaths.size&&Object.keys(this.state.geckoMetadata).length){var e=d(Array.from(this.state.selectedPaths).map(function(e){return e.slice(1)})),t=[],n=!0,a=!1,r=void 0;try{for(var s,o=this.state.bugComponentsMap.values()[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var i=s.value;!this.state.selectedPaths.has(i)&&e.test(i.slice(1))&&t.push(i)}}catch(Ye){a=!0,r=Ye}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}for(var c=d(t),l={},u=this.state.geckoMetadata,h=Object.keys(u),p=0;p<h.length;p++){var f=h[p];!e.test(f)||null!==c&&c.test(f)||(l[f]=u[f])}this.setState({pathMetadata:l})}function d(e){return e.length?new RegExp("^(?:".concat(e.join("|"),")(?:$|/)")):null}}},{key:"processComponentData",value:function(e){var t=e.components,n=e.paths,a=new Map,r=new Map,s="testing/web-platform/tests",o=[[s,n.testing["web-platform"].tests]],i=/(.*)\/[^\/]*$/,c=[];for(r.set("any",[]);o.length;)for(var l=o.pop(),u=Object(m.a)(l,2),h=u[0],p=u[1],f=!1,d=Object.keys(p),v=0;v<d.length;v++){var b=d[v],y=p[b];if("object"===typeof y){var g="".concat(h,"/").concat(b);o.push([g,y])}else{if(f||h===s)continue;for(var k=h,O=t[y].join("::"),j=O.toLowerCase();k!==s;){if(a.has(k)&&a.get(k)===j){f=!0;break}k=i.exec(k)[1]}if(!f){a.set(h,j),r.has(j)||(r.set(j,[]),c.push(O));var w=h.slice(s.length);r.get(j).push(w),r.get("any").push(w),f=!0}}}return[c,r]}},{key:"componentDidUpdate",value:function(){var e=Object(u.a)(c.a.mark(function e(t,n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.geckoMetadata===this.state.geckoMetadata&&O(n.selectedPaths,this.state.selectedPaths)||this.filterGeckoMetadata(),n.runSha===this.state.runSha){e.next=6;break}return this.setState({loading_state:me.LOADING}),e.next=5,this.loadWptRunData();case 5:this.setState({loading_state:me.COMPLETE});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.bugComponentsMap.get(this.state.currentBugComponent),t=[];return this.state.runSha&&t.push(r.a.createElement("section",{id:"selector",key:"selector"},r.a.createElement("dl",null,r.a.createElement(_e,{runSha:this.state.runSha,onChange:this.onRunChange}),r.a.createElement(De,{runs:this.state.wptRuns}),r.a.createElement(Pe,{onComponentChange:this.onComponentChange,components:this.state.bugComponents,value:this.state.currentBugComponent}),r.a.createElement(Ae,{onChange:this.onFilterChange}),r.a.createElement(Te,{paths:e,selectedPaths:this.state.selectedPaths,onChange:this.onPathsChange})))),this.state.loading_state!==me.COMPLETE?t.push(r.a.createElement("section",{id:"details",key:"details"},r.a.createElement("p",null,"Loading\u2026"))):t.push(r.a.createElement("section",{id:"details",key:"details"},r.a.createElement(Qe,null,r.a.createElement(Le,{label:"Interop Comparison",runs:this.state.wptRuns,paths:Array.from(this.state.selectedPaths),geckoMetadata:this.state.pathMetadata,onError:this.onError,filter:this.state.filterFunc},r.a.createElement("h2",null,"Interop Comparison")),r.a.createElement($e,{label:"Gecko Data",data:this.state.pathMetadata,paths:Array.from(this.state.selectedPaths),onError:this.onError},r.a.createElement("h2",null,"Gecko metadata"),r.a.createElement("p",null,"Gecko metadata in ",r.a.createElement("code",null,"testing/web-platform/meta")," taken from latest mozilla-central."),r.a.createElement("p",null,"Note: this data is currently not kept up to date"))))),r.a.createElement("div",{id:"app"},r.a.createElement(Me,{errors:this.state.errors,onDismissError:this.onDismissError}),r.a.createElement("header",null,r.a.createElement("h1",null,"wpt interop dashboard")),t)}}]),t}(a.Component),Me=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onDismiss=function(e){n.props.onDismissError(e)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.errors.length)return null;var t=[],n=!0,a=!1,s=void 0;try{for(var o,i=function(){var n=o.value,a=(l=Object(m.a)(n,2))[0],s=l[1];t.push(r.a.createElement(Ie,{key:"error-".concat(s.id),error:s,onDismiss:function(){return e.onDismiss(a)}}))},c=E(this.props.errors)[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var l;i()}}catch(Ye){a=!0,s=Ye}finally{try{n||null==c.return||c.return()}finally{if(a)throw s}}return r.a.createElement("ul",{className:"errors"},t)}}]),t}(a.Component),Ie=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.error,n=t.id,a=t.err,s=t.options,o=[];if(s.retry){o.push(r.a.createElement("button",{onClick:function(){e.props.onDismiss(n),s.retry()},key:"retry"},"Retry"))}return r.a.createElement("li",null,a.message||"Unknown Error",r.a.createElement("button",{onClick:function(){return e.props.onDismiss(n)}},"Close"),o)}}]),t}(a.Component),_e=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onInputChange=function(e){n.setState({newSha:e})},n.onEditClick=function(){n.setState({editable:!0})},n.onUpdateClick=function(){n.props.onChange(n.state.newSha),n.setState({editable:!1})},n.state={editable:!1,newSha:null,runShas:[]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,r,s,o,i,l,u,h,p,f,d,v,m,b;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=be("/api/runs",{"max-count":"100"}),e.next=3,ke(t);case 3:for(n=e.sent,a=new Map,r=!0,s=!1,o=void 0,e.prev=8,i=n[Symbol.iterator]();!(r=(l=i.next()).done);r=!0)u=l.value,a.has(u.revision)||a.set(u.revision,new Set),a.get(u.revision).add(u.browser_name);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),s=!0,o=e.t0;case 16:e.prev=16,e.prev=17,r||null==i.return||i.return();case 19:if(e.prev=19,!s){e.next=22;break}throw o;case 22:return e.finish(19);case 23:return e.finish(16);case 24:for(h=[],p=!0,f=!1,d=void 0,e.prev=28,v=n[Symbol.iterator]();!(p=(m=v.next()).done);p=!0)b=m.value,a.has(b.revision)&&3===a.get(b.revision).size&&h.push(b.revision),a.delete(b.revision);e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),f=!0,d=e.t1;case 36:e.prev=36,e.prev=37,p||null==v.return||v.return();case 39:if(e.prev=39,!f){e.next=42;break}throw d;case 42:return e.finish(39);case 43:return e.finish(36);case 44:this.setState({runShas:h});case 45:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23],[28,32,36,44],[37,,39,43]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(!this.props.runSha&&!this.state.editable)return null;var e=be("",{sha:this.props.runSha});return[r.a.createElement("dt",{key:"term"},"wpt SHA1:"),this.state.editable?r.a.createElement("dd",{key:"value"},this.state.runShas?r.a.createElement("datalist",{id:"runShasData"},this.state.runShas.map(function(e){return r.a.createElement("option",{key:e,value:e})})):null,r.a.createElement(ce,{defaultValue:this.props.runSha,onChange:this.onInputChange,list:"runShasData"}),r.a.createElement("button",{onClick:this.onUpdateClick},"Update")):r.a.createElement("dd",{key:"value"},r.a.createElement("a",{href:e},this.props.runSha.slice(0,12)),"\xa0\xa0",r.a.createElement("button",{onClick:this.onEditClick},"Edit"))]}}]),t}(a.Component),De=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if(!this.props.runs)return null;var e=this.props.runs.map(function(e){return r.a.createElement("li",{key:e.browser_name},ye(e.browser_name)," ",e.browser_version," (",e.os_name,")")});return[r.a.createElement("dt",{key:"term"},"Browsers:"),r.a.createElement("dd",{key:"value"},r.a.createElement("ul",null,e))]}}]),t}(a.Component),Pe=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.onComponentChange(e)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.components.map(function(e){return{value:e.toLowerCase(),name:e}});return this.props.value?[r.a.createElement("dt",{key:"term"},"Bug Component:"),r.a.createElement("dd",{key:"value"},r.a.createElement(le,{onChange:this.handleChange,value:this.props.value,options:e}))]:null}}]),t}(a.Component),Ae=function(e){function t(e){var n;Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).types=new Map(Object.entries({none:{name:"None",filter:null},untriaged:{name:"Untriaged",filter:"not has _geckoMetadata.bug"},triaged:{name:"Triaged",filter:"has _geckoMetadata.bug"},custom:{name:"Custom\u2026",filter:null}})),n.onTypeChange=function(e){var t;n.types.has(e)&&(n.setState({type:e}),(t="custom"===e?n.state.expr:n.types.get(e).filter)&&n.props.onChange(_(oe(t))))},n.onExprChange=function(e){var t;clearTimeout(n.timer);try{t=e?oe(e):null}catch(a){return void(n.timer=setTimeout(function(){console.log(a)},1e3))}n.timer=setTimeout(function(){var r;try{r=t?_(t):null}catch(a){return void console.error(a)}n.props.onChange(r),n.setState({expr:e})},1e3)};var a=n.getType(),r=Object(m.a)(a,2),s=r[0],o=r[1];return n.state={type:s,expr:o},n.afterFilterUpdate(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){t.type===this.state.type&&t.expr===this.state.expr||this.afterFilterUpdate()}},{key:"getType",value:function(){var e="none",t=null,n=Ce.get("filter");if(n){var a=n.split(":");e=a[0],t=a.slice(1).join(":")}return this.types.has(e)||(e="none",t=null),"custom"!==e&&(t=this.types.get(e).filter),[e,t]}},{key:"afterFilterUpdate",value:function(){var e=this.state.type;if("none"===e)Ce.delete("filter");else if("custom"===e){var t=this.state.expr;Ce.set("filter","custom:".concat(t))}else Ce.set("filter",e)}},{key:"render",value:function(){var e=r.a.createElement("p",{className:"note"},"Triaged status is currently derived from a bug: annotation in the gecko metadata on the test file (not on subtests). In the future this will change to include external annotations accessible to wpt.fyi."),t={triaged:e,untriaged:e,custom:r.a.createElement("div",{className:"note"},r.a.createElement("p",null,"Custom filters are boolean expressions with logical operators \xa0",r.a.createElement("code",null,"and"),", ",r.a.createElement("code",null,"or"),", and ",r.a.createElement("code",null,"not"),"`, equality operators ",r.a.createElement("code",null,"=="),", and ",r.a.createElement("code",null,"!="),"and custom operators ",r.a.createElement("code",null,"in")," for text substrings and ",r.a.createElement("code",null,"has")," for testing if a field exists."),r.a.createElement("p",null,"Available fields are ",r.a.createElement("code",null,"test")," for the test title and",r.a.createElement("code",null,"_geckoMetadata")," for fields set from gecko metadata Gecko metadata fields include ",r.a.createElement("code",null,"bug")," and",r.a.createElement("code",null,"lsan-allowed")),r.a.createElement("p",null,"The ",r.a.createElement("code",null,":")," operator performs a default operation depending on the selected field"),r.a.createElement("p",null,"Examples:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"historical in test"),' - The test name contains the substring "historical"'),r.a.createElement("li",null,r.a.createElement("code",null,"test:historical"),' - The test name contains the substring "historical"'),r.a.createElement("li",null,r.a.createElement("code",null,"not has _geckoMetadata.bug")," - Gecko metadata doesn't specify a bug field for the test"),r.a.createElement("li",null,r.a.createElement("code",null,"not has _geckoMetadata.bug")," - Gecko metadata doesn't specify a bug field for the test")))},n=Array.from(this.types).map(function(e){var t=Object(m.a)(e,2);return{value:t[0],name:t[1].name}});return[r.a.createElement("dt",{key:"term"},"Filter:"),r.a.createElement("dd",{key:"value"},r.a.createElement(le,{options:n,value:this.state.type,onChange:this.onTypeChange}),"custom"===this.state.type?r.a.createElement(ce,{onChange:this.onExprChange,defaultValue:this.state.expr}):null,t.hasOwnProperty(this.state.type)?t[this.state.type]:null)]}}]),t}(a.Component),Te=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onCheckboxChange=function(e,t){var a=new Set(n.state.paths);t?a.add(e):a.delete(e),n.setState({paths:a})},n.onUpdateClick=function(){n.props.onChange(n.state.paths)},n.state={paths:new Set(n.props.paths)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){e.selectedPaths!==this.props.selectedPaths&&this.setState({paths:new Set(this.props.selectedPaths)})}},{key:"render",value:function(){var e=this;if(!this.props.paths)return null;var t=this.props.paths.sort().map(function(t){return r.a.createElement("li",{key:t},r.a.createElement(ie,{checked:e.props.selectedPaths.has(t),value:t,onCheckboxChange:e.onCheckboxChange}),t)});return[r.a.createElement("dt",{key:"term"},"Test Paths"),r.a.createElement("dd",{key:"value"},r.a.createElement("button",{onClick:this.onUpdateClick,disabled:j(this.state.paths,this.props.selectedPaths)},"Update"),r.a.createElement("ul",{id:"test-paths"},t))]}}]),t}(a.Component),Le=function(e){function t(e){var n;Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onBrowserChange=function(e,t){n.setState({passesIn:e,failsIn:t});for(var a=[["passesIn",e],["failsIn",t]],r=0;r<a.length;r++){var s=a[r],o=Object(m.a)(s,2),i=o[0],c=o[1];O(c=c.sort(),n.defaultBrowsers[i])?Ce.delete(i):Ce.set(i,c.join(","))}},n.defaultBrowsers={failsIn:["firefox"],passesIn:["chrome","safari"]};var a=n.getComparison();return n.state={loading_state:me.NONE,results:[],filter:null,filteredResults:null,passesIn:a.passesIn,failsIn:a.failsIn},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getComparison",value:function(){for(var e={},t=Object.entries(this.defaultBrowsers),n=0;n<t.length;n++){var a=t[n],r=Object(m.a)(a,2),s=r[0],o=r[1];e[s]=o.slice()}for(var i=Object.keys(e),c=0;c<i.length;c++){var l=i[c];if(Ce.has(l)){var u=Ce.get(l),h=u.split(",").filter(function(e){return ve.includes(e)});u.length&&!h.length||(e[l]=h)}}return e}},{key:"buildQuery",value:function(){var e={run_ids:this.props.runs.map(function(e){return e.id}),query:{and:[]}},t=e.query.and,n=!0,a=!1,r=void 0;try{for(var s,o=this.state.failsIn[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var i=s.value,c=!0,l=!1,u=void 0;try{for(var h,p=de[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var f=h.value;t.push({not:{browser_name:i,status:f}})}}catch(Ye){l=!0,u=Ye}finally{try{c||null==p.return||p.return()}finally{if(l)throw u}}}}catch(Ye){a=!0,r=Ye}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}var d=!0,v=!1,m=void 0;try{for(var b,y=this.state.passesIn[Symbol.iterator]();!(d=(b=y.next()).done);d=!0){var g=b.value,k=void 0;if(de.size>1){var O={or:[]};t.push(O),k=O.or}else k=t;var j=!0,w=!1,E=void 0;try{for(var C,x=de[Symbol.iterator]();!(j=(C=x.next()).done);j=!0){var S=C.value;k.push({browser_name:g,status:S})}}catch(Ye){w=!0,E=Ye}finally{try{j||null==x.return||x.return()}finally{if(w)throw E}}}}catch(Ye){v=!0,m=Ye}finally{try{d||null==y.return||y.return()}finally{if(v)throw m}}return this.props.paths.length>1?t.push({or:this.props.paths.map(function(e){return{pattern:e+"/"}})}):t.push({pattern:this.props.paths[0]}),e}},{key:"fetchResults",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,r=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.buildQuery(),e.prev=1,e.next=4,ke(be("api/search",{}),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 4:n=e.sent,e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(1),this.props.onError(e.t0,{retry:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.fetchResults());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}),this.setState({loading_state:me.COMPLETE}),e.t0;case 12:a=new RegExp(this.props.paths.map(function(e){return"^".concat(e,"/")}).join("|")),n.results=n.results.filter(function(e){return a.test(e.test)}),n.results.forEach(function(e){return e._geckoMetadata=r.getMetadata(e.test)}),this.setState({results:n,loading_state:me.COMPLETE});case 16:case"end":return e.stop()}},e,this,[[1,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(e){var t=new Map,n=e.split("/"),a=n[n.length-1];n=n.slice(1,n.length-1);var r="";function s(e){for(var n=Object.entries(e),a=0;a<n.length;a++){var r=n[a],s=Object(m.a)(r,2),o=s[0],i=s[1];"_"!==o[0]&&t.set(o,i)}}var o=!0,i=!1,c=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var h=l.value;r.length&&(r+="/"),r+=h;var p=this.props.geckoMetadata[r];p&&s(p)}}catch(Ye){i=!0,c=Ye}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}var f=this.props.geckoMetadata[r];if(f&&f._tests&&f._tests[a]){var d=f._tests[a];if(s(d),d._subtests){t._subtests=new Map;for(var v=Object.entries(d._subtests),b=0;b<v.length;b++){var y=v[b],g=Object(m.a)(y,2),k=g[0],O=g[1];t._subtests.set(k,new Map(Object.entries(O)))}}}return t}},{key:"updateFilteredResults",value:function(){var e,t=this;e=this.state.results?this.props.filter?this.state.results.results.filter(function(e){return t.props.filter(e)}):this.state.results.results:this.state.results,this.setState({filteredResults:e})}},{key:"render",value:function(){var e,t=this;if(this.state.loading_state!==me.COMPLETE)e=r.a.createElement("div",null,r.a.createElement("p",null,"Loading\u2026"));else if(null===this.state.results)e=r.a.createElement("div",null,r.a.createElement("p",null,"Load failed"));else if(this.state.results.results.length){var n=this.state.filteredResults?this.state.filteredResults:[],a=n.map(function(e){return r.a.createElement(Ue,{failsIn:t.state.failsIn,passesIn:t.state.passesIn,runs:t.props.runs,result:e,key:e.test,geckoMetadata:e.test._geckoMetadata||new Map,onError:t.props.onError})});a.sort(function(e,t){return e.key>t.key?1:e.key===t.key?0:-1}),e=[r.a.createElement("p",{key:"desc"},n.length," top-level tests with \xa0",n.map(function(e){return e.legacy_status[0].total}).reduce(function(e,t){return e+t},0)," subtests"),r.a.createElement("ul",{key:"data"},a)]}else e=r.a.createElement("div",null,r.a.createElement("p",null,"No results"));return r.a.createElement("div",null,this.props.children,r.a.createElement(Ne,{failsIn:this.state.failsIn,passesIn:this.state.passesIn,onChange:this.onBrowserChange}),e)}},{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchIfPossible({},{});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(u.a)(c.a.mark(function e(t,n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchIfPossible(t,n);case 2:n.filter!==this.state.filter&&this.updateFilteredResults();case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchIfPossible",value:function(){var e=Object(u.a)(c.a.mark(function e(t,n){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.loading_state!==me.LOADING){e.next=2;break}return e.abrupt("return");case 2:if(null!==this.props.runs){e.next=4;break}return e.abrupt("return");case 4:if(this.props.paths){e.next=6;break}return e.abrupt("return");case 6:if(this.state.loading_state!==me.COMPLETE||this.props.paths!==t.paths||this.state.failsIn!==n.failsIn||this.state.passesIn!==n.passesIn){e.next=8;break}return e.abrupt("return");case 8:if(this.props.paths.length){e.next=11;break}return this.setState({results:{results:[]},loading_state:me.COMPLETE}),e.abrupt("return");case 11:return this.setState({results:null,loading_state:me.LOADING}),e.next=14,this.fetchResults();case 14:this.updateFilteredResults();case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),t}(a.Component),Ne=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).onEditClick=function(){n.setState({editable:!0})},n.onSelectChange=function(e,t){var a,r={};"passesIn"===t?a="newPassesIn":"failsIn"===t?a="newFailsIn":console.error("Unknown key ".concat(t)),r[a]=e,n.setState(r)},n.onUpdateClick=function(){n.props.onChange(n.state.newPassesIn,n.state.newFailsIn),n.setState({editable:!1})},n.state={editable:!1,newPassesIn:n.props.passesIn,newFailsIn:n.props.failsIn},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"joinList",value:function(e){if(!e.length)return"";if(1===e.length)return e[0];var t=e.slice(0,e.length-1).join(", ");return"".concat(t,", and ").concat(e[e.length-1])}},{key:"render",value:function(){var e,t=this;if(this.state.editable){var n=ve.map(function(e){return{value:e,name:ye(e),selected:t.props.passesIn.includes(e)}}),a=ve.map(function(e){return{value:e,name:ye(e),selected:t.props.failsIn.includes(e)}});return r.a.createElement("p",null,"Tests that \xa0",r.a.createElement("label",null,"pass in\xa0",r.a.createElement(he,{onChange:function(e){return t.onSelectChange(e,"passesIn")},options:n})),"\xa0but",r.a.createElement("label",null,"\xa0not in\xa0",r.a.createElement(ue,{onChange:function(e){return t.onSelectChange(e,"failsIn")},options:a})),"\xa0",r.a.createElement("button",{onClick:this.onUpdateClick,disabled:0===this.state.newPassesIn.length&&0===this.state.newFailsIn.length},"Update"))}return e=this.props.passesIn.length&&this.props.failsIn.length?"Tests that pass in ".concat(this.joinList(this.props.passesIn.map(function(e){return ye(e)})),"\nbut not in ").concat(this.joinList(this.props.failsIn.map(function(e){return ye(e)}))):this.props.passesIn.length?"Tests that pass in ".concat(this.joinList(this.props.passesIn.map(function(e){return ye(e)}))):"Tests that don't pass in ".concat(this.joinList(this.props.failsIn.map(function(e){return ye(e)}))),r.a.createElement("p",null,e,"\xa0",r.a.createElement("button",{onClick:this.onEditClick},"Edit"))}}]),t}(a.Component),Re=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleClick=function(){n.setState({showDetails:!n.state.showDetails})},n.state={showDetails:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("li",{className:"tree-row"+(this.state.showDetails?" tree-row-expanded":"")},r.a.createElement("span",{onClick:this.handleClick},this.state.showDetails?"\u25bc ":"\u25b6 ",this.props.rowTitle),this.props.rowExtra,this.state.showDetails?r.a.createElement("div",{className:"tree-row"},this.props.children):"")}}]),t}(a.Component),Ue=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e="".concat(this.props.result.test," [").concat(this.props.result.legacy_status[0].total," subtests]");return r.a.createElement(Re,{rowTitle:r.a.createElement("code",null,e),rowExtra:null},r.a.createElement(ze,{runs:this.props.runs,test:this.props.result.test,passesIn:this.props.passesIn,failsIn:this.props.failsIn,geckoMetadata:this.props.geckoMetadata,onError:this.props.onError}))}}]),t}(a.Component),ze=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={loaded:!1,results:null},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"processResultData",value:function(e){var t=this,n=new Map,a=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var c=o.value,l=Object(m.a)(c,2),u=l[0],h=l[1];n.has(null)||n.set(null,new Map),n.get(null).set(u,{status:h.status,message:h.message});var p=!0,f=!1,d=void 0;try{for(var v,b=h.subtests[Symbol.iterator]();!(p=(v=b.next()).done);p=!0){var y=v.value;n.has(y.name)||n.set(y.name,new Map),n.get(y.name).set(u,{status:y.status,message:y.message})}}catch(Ye){f=!0,d=Ye}finally{try{p||null==b.return||b.return()}finally{if(f)throw d}}}}catch(Ye){r=!0,s=Ye}finally{try{a||null==i.return||i.return()}finally{if(r)throw s}}var g=!0,k=!1,O=void 0;try{for(var j,w=n.values()[Symbol.iterator]();!(g=(j=w.next()).done);g=!0){var E=j.value,C=!0,x=!1,S=void 0;try{for(var M,I=this.props.runs[Symbol.iterator]();!(C=(M=I.next()).done);C=!0){var _=M.value.browser_name;E.has(_)||E.set(_,{status:"MISSING",message:null})}}catch(Ye){x=!0,S=Ye}finally{try{C||null==I.return||I.return()}finally{if(x)throw S}}}}catch(Ye){k=!0,O=Ye}finally{try{g||null==w.return||w.return()}finally{if(k)throw O}}var D=new Map,P=!0,A=!1,T=void 0;try{for(var L,N=function(){var e=L.value,n=(U=Object(m.a)(e,2))[0],a=U[1];t.props.passesIn.every(function(e){return de.has(a.get(e).status)})&&t.props.failsIn.every(function(e){return!de.has(a.get(e).status)})&&D.set(n,a)},R=n[Symbol.iterator]();!(P=(L=R.next()).done);P=!0){var U;N()}}catch(Ye){A=!0,T=Ye}finally{try{P||null==R.return||R.return()}finally{if(A)throw T}}var z=[];return D.has(null)&&(z.push([null,D.get(null)]),D.delete(null)),z.concat(Array.from(D))}},{key:"fetchData",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,r,s,o,i,l,u,h,p,f,d,v,b,y,g,k,O,j,w,C,x,S,M,I;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new Map,n=[],a=[],r=!0,s=!1,o=void 0,e.prev=6,i=this.props.runs[Symbol.iterator]();!(r=(l=i.next()).done);r=!0)u=l.value,h=u.browser_name,p=u.results_url,(f=p.split("-")).pop(),d="".concat(f.join("-")).concat(this.props.test),v=ke(d).then(function(e){return{success:!0,value:e}}).catch(function(e){return{success:!1,value:e}}),n.push(h),a.push(v);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),s=!0,o=e.t0;case 14:e.prev=14,e.prev=15,r||null==i.return||i.return();case 17:if(e.prev=17,!s){e.next=20;break}throw o;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.next=24,Promise.all(a);case 24:for(b=e.sent,y=!0,g=!1,k=void 0,e.prev=28,O=E(b)[Symbol.iterator]();!(y=(j=O.next()).done);y=!0)w=j.value,C=Object(m.a)(w,2),x=C[0],(S=C[1]).success&&(M=n[x],t.set(M,S.value));e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),g=!0,k=e.t1;case 36:e.prev=36,e.prev=37,y||null==O.return||O.return();case 39:if(e.prev=39,!g){e.next=42;break}throw k;case 42:return e.finish(39);case 43:return e.finish(36);case 44:I=this.processResultData(t),this.setState({results:I,loaded:!0});case 46:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21],[28,32,36,44],[37,,39,43]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.state.loaded)return r.a.createElement("p",null,"Loading");var t=this.props.runs.map(function(e){return r.a.createElement("th",{key:e.browser_name},e.browser_name)});t.push(r.a.createElement("th",{key:"metadata"}));var n=this.props.geckoMetadata.get("_subtests")||new Map,a=this.state.results.map(function(t){var a=Object(m.a)(t,2),s=a[0],o=a[1];return r.a.createElement(Be,{key:s,runs:e.props.runs,subtest:s,results:o,geckoMetadata:n.get(s)})});return r.a.createElement("div",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"http://w3c-test.org".concat(this.props.test)},"Live test")),r.a.createElement("li",null,r.a.createElement("a",{href:be("results/".concat(this.props.test))},"wpt.fyi")),r.a.createElement("li",null,r.a.createElement("a",{href:"http://searchfox.org/mozilla-central/source/testing/web-platform/meta".concat(Ee(this.props.test),".ini")},"Gecko Metadata"))),r.a.createElement(Fe,{test:this.props.test,data:this.props.geckoMetadata}),r.a.createElement("section",null,r.a.createElement("h3",null,"Results"),r.a.createElement("table",{className:"results"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),t)),r.a.createElement("tbody",null,a))))}}]),t}(a.Component),Fe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,n=function(e){return r.a.createElement(Ve,{value:e})};this.props.data?e=[{name:"disabled",render:n},{name:"bug",render:n},{name:"crash",title:"Crashes",render:n}].map(function(e){return t.props.data.has(e.name)?r.a.createElement(Ge,{key:e.name,title:e.title?e.title:ye(e.name),values:t.props.data.get(e.name),render:e.render}):null}).filter(function(e){return null!==e}):e=[];return 0===e.length?null:r.a.createElement("section",null,r.a.createElement("h3",null,"Gecko Metadata"),r.a.createElement("ul",null,e))}}]),t}(a.Component),Ge=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.props.values?1===this.props.values.length&&null===this.props.values[0][0]?r.a.createElement("li",null,this.props.title,": ",this.props.render(this.props.values[0])):r.a.createElement(He,{title:this.props.title,values:this.props.values,render:this.props.render}):null}}]),t}(a.Component),Be=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.runs.map(function(t){var n=e.props.results.get(t.browser_name);return r.a.createElement(We,{result:n,key:t.browser_name})});return t.push(r.a.createElement("td",{key:"metadata"},r.a.createElement(Fe,{data:this.props.geckoMetadata}))),r.a.createElement("tr",null,r.a.createElement("th",null,this.props.subtest?this.props.subtest:"<parent>"),t)}}]),t}(a.Component),We=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("td",{className:"result result-".concat(this.props.result.status.toLowerCase()),title:this.props.result.message},this.props.result.status)}}]),t}(a.Component),$e=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"groupData",value:function(){for(var e={unconditional:new Map,conditional:new Map},t={unconditional:new Map,conditional:new Map},n={unconditional:new Map,conditional:new Map},a=function(e,t,n,a){var r;t&&t.length&&(r=1===t.length&&null==t[0][0]?"unconditional":"conditional",a&&(t=t.map(a)),n[r].set(e,t))},r=Object.entries(this.props.data),s=0;s<r.length;s++){var o=r[s],i=Object(m.a)(o,2),c=i[0],l=i[1];if(a(c,l.disabled,e),a(c,l["lsan-allowed"],t),a(c,l.expected_CRASH,n,function(e){return[e,null]}),l._tests)for(var u=Object.entries(l._tests),h=0;h<u.length;h++){var p=u[h],f=Object(m.a)(p,2),d=f[0],v=f[1],b="".concat(c,"/").concat(d);if(a(b,v.disabled,e),a(b,v.expected_CRASH,n,function(e){return[e,null]}),v._subtests)for(var y=Object.entries(v._subtests),g=0;g<y.length;g++){var k=y[g],O=Object(m.a)(k,2),j=O[0],w=O[1],E="".concat(c,"/").concat(d," | ").concat(j);a(E,w.disabled,e),a(E,w.expected_CRASH,n,function(e){return[e,null]})}}}return{disabled:e,lsan:t,crashes:n}}},{key:"render",value:function(){if(!this.props.data)return r.a.createElement("p",null,"Loading");var e=this.groupData();return null!==e&&Object.values(e).some(function(e){return Object.values(e).some(function(e){return e.size>0})})?(console.log(e),r.a.createElement("section",null,r.a.createElement("h2",null,"Gecko metadata"),r.a.createElement(qe,{key:"crashes",data:e.crashes,render:function(e){return null},title:"Crashes",desc:"tests crash"}),r.a.createElement(qe,{key:"disabled",data:e.disabled,render:function(e){return r.a.createElement(Ve,{value:e})},title:"Disabled",desc:"tests are disabled"}),r.a.createElement(qe,{key:"lsan",data:e.lsan,render:function(e){return r.a.createElement(Je,{value:e})},title:"LSAN Failures",desc:"directories have LSAN failures"}))):r.a.createElement("section",null,r.a.createElement("h2",null,"Gecko metadata"),r.a.createElement("p",null,"None"))}}]),t}(a.Component),qe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.data,t=e.conditional,n=e.unconditional;if(!t.size&&!n.size)return null;for(var a=0,s=[],o=[["In all configurations",n],["In some configurations",t]],i=0;i<o.length;i++){var c=o[i],l=Object(m.a)(c,2),u=l[0],h=l[1];if(h.size){s.push(r.a.createElement("h4",{key:u},u));var p=!0,f=!1,d=void 0;try{for(var v,b=w(h)[Symbol.iterator]();!(p=(v=b.next()).done);p=!0){var y=v.value,g=Object(m.a)(y,2),k=g[0],O=g[1];a++,s.push(r.a.createElement(He,{key:k,title:k,values:O,render:this.props.render}))}}catch(Ye){f=!0,d=Ye}finally{try{p||null==b.return||b.return()}finally{if(f)throw d}}}}return r.a.createElement("section",null,r.a.createElement("h3",null,this.props.title),r.a.createElement("p",null,a," ",this.props.desc),r.a.createElement("ul",null,s))}}]),t}(a.Component),He=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var s,o=this.props.values[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var i=s.value,c=Object(m.a)(i,2),l=c[0],u=c[1],h=l?"if ".concat(l).concat(u?": ":" "):"";e.push(r.a.createElement("li",{key:l||"None"},r.a.createElement("code",null,h),u?this.props.render(u):null))}}catch(Ye){n=!0,a=Ye}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}var p=null;return e.length&&(p=r.a.createElement("ul",{className:"tree-row"},e)),r.a.createElement(Re,{rowTitle:this.props.title,rowExtra:null},p)}}]),t}(a.Component),Ve=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=[/https?:\/\/bugzilla\.mozilla\.org\/show_bug\.cgi\?id=(\d+)/,/(?:bug\s+)?(\d+)/i],t=0;t<e.length;t++){var n=e[t].exec(this.props.value);if(null!==n)return r.a.createElement("a",{href:"https://bugzilla.mozilla.org/show_bug.cgi?id=".concat(n[1])},"Bug ",n[1])}return this.props.value}}]),t}(a.Component),Je=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if(console.log(this.props.value),Array.isArray(this.props.value)){var e=this.props.value.map(function(e){return r.a.createElement("li",{key:e},r.a.createElement("code",null,e))});return r.a.createElement("ul",null,e)}return this.props.value}}]),t}(a.Component),Qe=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleClickTab=function(e){n.setState({activeTab:e}),Ce.set("tab",e)},n.state={activeTab:Ce.get("tab")||n.props.children[0].props.label},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.children.map(function(t){var n=t.props.label;return r.a.createElement(Ke,{active:e.state.activeTab===n,label:n,key:n,onClick:e.handleClickTab})}),n=this.props.children.find(function(t){return t.props.label===e.state.activeTab});return r.a.createElement("div",{className:"tab-view"},r.a.createElement("ol",{className:"tab-strip"},t),r.a.createElement("div",{className:"tab-content"},n))}}]),t}(a.Component),Ke=function(e){function t(){var e,n;Object(h.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){n.props.onClick(n.props.label)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("li",{className:"tab-label "+(this.props.active?"tab-active":""),onClick:this.onClick},this.props.label)}}]),t}(a.Component),Xe=Se;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Xe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[13,2,1]]]);
//# sourceMappingURL=main.a62079b5.chunk.js.map