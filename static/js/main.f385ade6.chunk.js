(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(25)},19:function(e,t,a){},23:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(12),o=a.n(s),i=(a(19),a(1)),l=a.n(i),c=a(4),u=a(8),h=a(2),p=a(6),f=a(3),d=a(5),v=a(10),m=a(7),b=(a(23),l.a.mark(k)),y=l.a.mark(j),g=l.a.mark(E);function k(e){var t;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t=e.length;case 1:if(!(t>0)){a.next=7;break}return t--,a.next=5,e[t];case 5:a.next=1;break;case 7:case"end":return a.stop()}},b,this)}function w(e,t){return e===t||!(!Array.isArray(e)||!Array.isArray(t))&&(e.length===t.length&&e.every(function(e,a){return e===t[a]}))}function O(e,t){if(e.size!==t.size)return!1;var a=!0,n=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var i=s.value;if(!t.has(i))return!1}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return!0}function j(e,t){var a,n,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(a=Array.from(e.keys())).sort(),n=0;case 3:if(!(n<a.length)){t.next=10;break}return r=a[n],t.next=7,[r,e.get(r)];case 7:n++,t.next=3;break;case 10:case"end":return t.stop()}},y,this)}function E(e){var t,a,n,r,s,o,i;return l.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:t=0,a=!0,n=!1,r=void 0,l.prev=4,s=e[Symbol.iterator]();case 6:if(a=(o=s.next()).done){l.next=14;break}return i=o.value,l.next=10,[t,i];case 10:t++;case 11:a=!0,l.next=6;break;case 14:l.next=20;break;case 16:l.prev=16,l.t0=l.catch(4),n=!0,r=l.t0;case 20:l.prev=20,l.prev=21,a||null==s.return||s.return();case 23:if(l.prev=23,!n){l.next=26;break}throw r;case 26:return l.finish(23);case 27:return l.finish(20);case 28:case"end":return l.stop()}},g,this,[[4,16,20,28],[21,,23,27]])}var x=l.a.mark(P),C=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),t}(Object(v.a)(Error)),S={and:function(e){if(!Array.isArray(e))throw new C("Argument to 'and' clause must be an array");var t=[],a=!0,n=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var i=s.value;t.push(D(i))}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return M.and.apply(M,t)},or:function(e){if(!Array.isArray(e))throw new C("Argument to 'or' clause must be an array");var t=[],a=!0,n=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var i=s.value;t.push(D(i))}}catch(l){n=!0,r=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}return M.or.apply(M,t)},"==":function(e){return M["=="](e)},not:function(e){var t=Object(m.a)(e,1)[0];return M.not(D(t))},in:function(e){return M.in(e)},has:function(e){var t=Object(m.a)(e,1)[0];if("string"!==typeof t)throw new C("Argument to 'has' clause must be a string");return M.has(t)}},M={and:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.every(function(t){return t(e)})}},or:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return function(e){return t.some(function(t){return t(e)})}},"==":function(e){var t=Object(m.a)(e,2);return t[0]===t[1]},not:function(e){return function(t){return!e(t)}},in:function(e){var t=Object(m.a)(e,2),a=t[0],n=t[1];return function(e){var t=_(e,n);if("string"!==typeof t)throw new C;return t.includes(a)}},has:function(e){return function(t){return void 0!==_(t,e)}}};function _(e,t){var a=t.split("."),n=e,r=!0,s=!1,o=void 0;try{for(var i,l=a[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var c=i.value;if(void 0===(n=n instanceof Map?n.get(c):n[c]))return}}catch(u){s=!0,o=u}finally{try{r||null==l.return||l.return()}finally{if(s)throw o}}return n}function D(e){var t=Object.keys(e);if(1!==t.length)throw console.error(e),new C("Can't handle an input with multiple keys");var a=t[0];if(!S.hasOwnProperty(a))throw console.error(e),new C("Unknown operator ".concat(a));return S[a](e[a])}var A=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),t}(Object(v.a)(Error));function P(e){var t,a,n,r,s,o;return l.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=/\s*/,a=/\w(?:\w|\d|\.|_|\-|\+)*|\d+|==|!=|\(|\)|:|".*?[^\\]"|'.*?[^\\]'/,n=e.length;case 3:if(!e.length){i.next=19;break}if(!(r=e.match(t))[0].length){i.next=10;break}if(s=r[0].length,(e=e.slice(s)).length){i.next=10;break}return i.abrupt("break",19);case 10:if(r=e.match(a)){i.next=13;break}throw new A("Invalid input at character ".concat(n-e.length));case 13:return o=r[0],i.next=16,o;case 16:e=e.slice(o.length),i.next=3;break;case 19:case"end":return i.stop()}},x,this)}var T=new Set(["==","!=","in","and","or","!","not",":","has"]),I=new Set(["!","not","has"]),R=[[":"],["in","==","!=","has"],["not","!"],["and"],["or"]],N=new Map,L=!0,F=!1,G=void 0;try{for(var U,z=R.map(function(e,t){return[t,e]})[Symbol.iterator]();!(L=(U=z.next()).done);L=!0){var B=U.value,H=Object(m.a)(B,2),W=H[0],q=H[1],$=!0,V=!1,J=void 0;try{for(var Q,K=q[Symbol.iterator]();!($=(Q=K.next()).done);$=!0){var Y=Q.value;N.set(Y,R.length-W)}}catch(qe){V=!0,J=qe}finally{try{$||null==K.return||K.return()}finally{if(V)throw J}}}}catch(qe){F=!0,G=qe}finally{try{L||null==z.return||z.return()}finally{if(F)throw G}}var X=new Map(Object.entries({"!":"not"})),Z=new Map(Object.entries({test:"in"})),ee=function(){function e(t){Object(h.a)(this,e),this.name=t}return Object(c.a)(e,[{key:"to_object",value:function(){var e={};return e[this.name]=this.children().map(function(e){return e.to_object()}),e}}]),e}(),te=function(e){function t(e){var a;if(Object(h.a)(this,t),!T.has(e)||!I.has(e))throw new Error;return X.has(e)&&(e=X.get(e)),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).operand=null,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"children",value:function(){return[this.operand]}}]),t}(ee),ae=function(e){function t(e){var a;if(Object(h.a)(this,t),!T.has(e)||I.has(e))throw new Error;return X.has(e)&&(e=X.get(e)),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).lhs=null,a.rhs=null,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"children",value:function(){return[this.lhs,this.rhs]}}]),t}(ee),ne=function(e){function t(e){return Object(h.a)(this,t),"'"!==e[0]&&'"'!==e[0]||(e=e.slice(1,e.length-1)),Object(p.a)(this,Object(f.a)(t).call(this,e))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"to_object",value:function(){return this.name}}]),t}(ee);function re(e){return I.has(e)?new te(e):new ae(e)}var se=function(){function e(){Object(h.a)(this,e),this.operators=[],this.operands=[]}return Object(c.a)(e,[{key:"top",value:function(){return this.operators.length?this.operators[this.operators.length-1]:null}},{key:"parse",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;if("("===o)this.operators.push(o);else if(")"===o){for(;null!==this.top()&&"("!==this.top();)this.apply();if(!this.operators.length)throw new A("Mismatched parens");this.operators.pop()}else if(T.has(o)){for(;null!==this.top()&&")"!==this.top()&&this.precedence(this.top().name)>=this.precedence(o);)this.apply();this.operators.push(re(o))}else this.operands.push(new ne(o))}}catch(qe){a=!0,n=qe}finally{try{t||null==s.return||s.return()}finally{if(a)throw n}}for(;this.operators.length;)this.apply();if(1!==this.operands.length)throw new A("Operands remaining at end of input");return this.operands[0]}},{key:"precedence",value:function(e){return N.get(e)}},{key:"apply",value:function(){var e=this.operators.pop();if(I.has(e.name)){var t=this.operands.pop();if(!t)throw new Error;e.operand=t}else{var a=this.operands.pop(),n=this.operands.pop();if(!n||!a)throw new Error;e.lhs=n,e.rhs=a,":"===e.name&&(e=function(e){var t="==";if(Z.has(e.lhs.name)&&(t=Z.get(e.lhs.name)),e.name=t,"in"===t){var a=[e.rhs,e.lhs];e.lhs=a[0],e.rhs=a[1]}return e}(e))}this.operands.push(e)}}]),e}();function oe(e){return(new se).parse(P(e)).to_object()}var ie=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleChange=function(e){a.setState({checked:!!e.target.checked}),a.props.onCheckboxChange(a.props.value,e.target.checked)},a.state={checked:a.props.checked},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("input",{name:this.props.name,type:"checkbox",checked:this.state.checked,onChange:this.handleChange})}}]),t}(n.Component),le=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=e.target.value;a.props.onChange(t)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("input",{name:this.props.name,onChange:this.handleChange,defaultValue:this.props.defaultValue,list:this.props.list})}}]),t}(n.Component),ce=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.onChange(e.target.value)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.options.map(function(e){return r.a.createElement("option",{value:e.value,key:e.value},e.name)});return r.a.createElement("select",{onChange:this.handleChange,value:this.props.value},e)}}]),t}(n.Component),ue=(n.Component,"https://queue.taskcluster.net/v1/task"),he="https://wpt.fyi",pe=new Set(["PASS","OK"]),fe=Object.freeze({NONE:0,LOADING:1,COMPLETE:2});function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=new URL("".concat(he,"/").concat(e)),n=[["label","master"],["product","chrome[experimental]"],["product","firefox[experimental]"],["product","safari[experimental]"]];t=new Map(Object.entries(t));for(var r=0;r<n.length;r++){var s=n[r],o=Object(m.a)(s,2),i=o[0],l=o[1];t.has(i)||a.searchParams.append(i,l)}var c=!0,u=!1,h=void 0;try{for(var p,f=function(){var e=p.value,t=(v=Object(m.a)(e,2))[0],n=v[1];if(null===n||void 0===n)return"continue";Array.isArray(n)?n.forEach(function(e){return a.searchParams.append(t,e)}):a.searchParams.append(t,n)},d=t[Symbol.iterator]();!(c=(p=d.next()).done);c=!0){var v;f()}}catch(qe){u=!0,h=qe}finally{try{c||null==d.return||d.return()}finally{if(u)throw h}}return a}var ve=function(e){function t(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(h.a)(this,t),n||(n="Fetch for ".concat(e.url," returned status ").concat(e.status," ").concat(e.statusText)),(a=Object(p.a)(this,Object(f.a)(t).call(this,n))).resp=e,a.name="FetchError",a}return Object(d.a)(t,e),t}(Object(v.a)(Error));function me(e,t){return be.apply(this,arguments)}function be(){return(be=Object(u.a)(l.a.mark(function e(t,a){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:if((n=e.sent).ok){e.next=5;break}throw new ve(n);case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var ye=/^(.*\.any)(:?\..*)\.html$/,ge=/^(.*\.(:?worker|window))\.html$/;function ke(e){var t=new URL("https://web-platform.test".concat(e)).pathname,a=ye.exec(t);return null===a&&(a=ge.exec(t)),null!==a&&(t=a[1]+".js"),t}var we=new(function(){function e(){Object(h.a)(this,e),this.url=new URL(window.location),this.params=this.url.searchParams}return Object(c.a)(e,[{key:"_update",value:function(){window.history.replaceState({},document.title,this.url.href)}},{key:"get",value:function(e){return this.params.get(e)}},{key:"has",value:function(e){return this.params.has(e)}},{key:"set",value:function(e,t){this.params.set(e,t),this._update()}},{key:"delete",value:function(e){this.params.delete(e),this._update()}},{key:"append",value:function(e,t){this.params.append(e,t),this._update()}}]),e}()),Oe=function(){var e=-1;return function(t,a){return{id:++e,err:t,options:a}}}(),je=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).onError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Oe(e,t);a.setState(function(e){return{errors:e.errors.concat(n)}})},a.onDismissError=function(e){var t=Array.from(a.state.errors),n=t.findIndex(function(t){return t.id===e});void 0!==n&&(t.splice(n,1),a.setState({errors:t}))},a.onFilterChange=function(e){a.setState({filterFunc:e})},a.onRunChange=function(e){a.setState({runSha:e})},a.onComponentChange=function(e){var t=e.toLowerCase(),n=new Set(a.state.bugComponentsMap.get(t));we.set("bugComponent",e),we.delete("paths"),a.setState({currentBugComponent:t,selectedPaths:n})},a.onPathsChange=function(e){var t=Array.from(e);t.sort(),w(t,a.state.bugComponentsMap.get(a.state.currentBugComponent))?we.delete("paths"):we.set("paths",t.join(",")),a.setState({selectedPaths:e})},a.state={bugComponents:[],bugComponentsMap:new Map,currentBugComponent:null,selectedPaths:new Set,runSha:null,wptRuns:null,geckoMetadata:{},geckoMetadataForPaths:{},errors:[],loading_state:fe.NONE,filter:null,filterFunc:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"fetchData",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a){var n,r=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=r.length>2&&void 0!==r[2]?r[2]:{}).hasOwnProperty("redirect")||(n.redirect="follow"),e.prev=2,e.next=5,me(t,n);case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),this.onError(e.t0,{retry:a}),e.t0;case 12:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"loadTaskClusterData",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a){var n,r,s,o,i,c,h,p,f,d,v,m,b,y=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.loadTaskClusterData(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),e.next=3,this.fetchData("".concat("https://index.taskcluster.net/v1/task","/").concat(t),n);case 3:return r=e.sent,s=r.taskId,e.next=7,this.fetchData("".concat(ue,"/").concat(s,"/status"),n);case 7:o=e.sent,c=!0,h=!1,p=void 0,e.prev=11,f=k(o.status.runs)[Symbol.iterator]();case 13:if(c=(d=f.next()).done){e.next=21;break}if("completed"!==(v=d.value).state){e.next=18;break}return i=v.runId,e.abrupt("break",21);case 18:c=!0,e.next=13;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(11),h=!0,p=e.t0;case 27:e.prev=27,e.prev=28,c||null==f.return||f.return();case 30:if(e.prev=30,!h){e.next=33;break}throw p;case 33:return e.finish(30);case 34:return e.finish(27);case 35:return e.next=37,this.fetchData("".concat(ue,"/").concat(s,"/runs/").concat(i,"/artifacts"),n);case 37:return m=e.sent,b=m.artifacts.find(function(e){return e.name.endsWith(a)}),e.abrupt("return",this.fetchData("".concat(ue,"/").concat(s,"/runs/").concat(i,"/artifacts/").concat(b.name),n));case 40:case"end":return e.stop()}},e,this,[[11,23,27,35],[28,,30,34]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"loadBugComponentData",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r,s,o,i,c,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadTaskClusterData("gecko.v2.mozilla-central.latest.source.source-bugzilla-info","components-normalized.json");case 2:t=e.sent,a=this.processComponentData(t),n=Object(m.a)(a,2),r=n[0],s=n[1],(r=Array.from(r).sort()).push("Any"),this.setState({bugComponentsMap:s,bugComponents:r}),!(o=this.state.currentBugComponent)&&we.has("bugComponent")&&(i=we.get("bugComponent"),s.has(i)&&(o=i)),o||(o=r[0].toLowerCase()),c=new Set(s.get(o)),we.has("paths")&&(u=new Set(we.get("paths").split(",")),c=new Set(Array.from(c).filter(function(e){return u.has(e)}))),this.setState({selectedPaths:c,currentBugComponent:o});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadWptRunData",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r,s=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={aligned:""},this.state.runSha&&(t.sha=this.state.runSha),a=de("api/runs",t),e.next=5,this.fetchData(a,Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",s.loadWptRunData());case 1:case"end":return e.stop()}},e,this)})));case 5:n=e.sent,r=n[0].full_revision_hash,this.setState({wptRuns:n,runSha:r});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadGeckoMetadata",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData("https://queue.taskcluster.net/v1/task/YtpxIfHTR5CKgd4EfpkAQg/runs/0/artifacts/public/summary.json",Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.loadGeckoMetadata());case 1:case"end":return e.stop()}},e,this)})));case 2:t=e.sent,this.setState({geckoMetadata:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading_state:fe.LOADING}),t=this.loadBugComponentData(),a=this.loadWptRunData(),n=this.loadGeckoMetadata(),e.next=6,Promise.all([t,a,n]);case 6:this.setState({loading_state:fe.COMPLETE});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"filterGeckoMetadata",value:function(){if(this.state.selectedPaths.size&&Object.keys(this.state.geckoMetadata).length){var e=d(Array.from(this.state.selectedPaths).map(function(e){return e.slice(1)})),t=[],a=!0,n=!1,r=void 0;try{for(var s,o=this.state.bugComponentsMap.values()[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var i=s.value;!this.state.selectedPaths.has(i)&&e.test(i.slice(1))&&t.push(i)}}catch(qe){n=!0,r=qe}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}for(var l=d(t),c={},u=this.state.geckoMetadata,h=Object.keys(u),p=0;p<h.length;p++){var f=h[p];!e.test(f)||null!==l&&l.test(f)||(c[f]=u[f])}this.setState({pathMetadata:c})}function d(e){return e.length?new RegExp("^(?:".concat(e.join("|"),")(?:$|/)")):null}}},{key:"processComponentData",value:function(e){var t=e.components,a=e.paths,n=new Map,r=new Map,s="testing/web-platform/tests",o=[[s,a.testing["web-platform"].tests]],i=/(.*)\/[^\/]*$/,l=[];for(r.set("any",[]);o.length;)for(var c=o.pop(),u=Object(m.a)(c,2),h=u[0],p=u[1],f=!1,d=Object.keys(p),v=0;v<d.length;v++){var b=d[v],y=p[b];if("object"===typeof y){var g="".concat(h,"/").concat(b);o.push([g,y])}else{if(f||h===s)continue;for(var k=h,w=t[y].join("::"),O=w.toLowerCase();k!==s;){if(n.has(k)&&n.get(k)===O){f=!0;break}k=i.exec(k)[1]}if(!f){n.set(h,O),r.has(O)||(r.set(O,[]),l.push(w));var j=h.slice(s.length);r.get(O).push(j),r.get("any").push(j),f=!0}}}return[l,r]}},{key:"componentDidUpdate",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.geckoMetadata===this.state.geckoMetadata&&w(a.selectedPaths,this.state.selectedPaths)||this.filterGeckoMetadata(),a.runSha===this.state.runSha){e.next=6;break}return this.setState({loading_state:fe.LOADING}),e.next=5,this.loadWptRunData();case 5:this.setState({loading_state:fe.COMPLETE});case 6:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.bugComponentsMap.get(this.state.currentBugComponent),t=[];return this.state.runSha&&t.push(r.a.createElement("section",{id:"selector",key:"selector"},r.a.createElement(Ce,{runSha:this.state.runSha,onChange:this.onRunChange}),r.a.createElement(Se,{onComponentChange:this.onComponentChange,components:this.state.bugComponents,value:this.state.currentBugComponent}),r.a.createElement(Me,{onChange:this.onFilterChange}),r.a.createElement(_e,{paths:e,selectedPaths:this.state.selectedPaths,onChange:this.onPathsChange}))),this.state.loading_state!==fe.COMPLETE?t.push(r.a.createElement("section",{id:"details",key:"details"},r.a.createElement("p",null,"Loading\u2026"))):t.push(r.a.createElement("section",{id:"details",key:"details"},r.a.createElement(Be,null,r.a.createElement(De,{label:"Firefox-only Failures",failsIn:["firefox"],passesIn:["safari","chrome"],runs:this.state.wptRuns,paths:Array.from(this.state.selectedPaths),geckoMetadata:this.state.pathMetadata,onError:this.onError,filter:this.state.filterFunc},r.a.createElement("h2",null,"Firefox-only Failures"),r.a.createElement("p",null,"Tests that pass in Chrome and Safari but fail in Firefox.")),r.a.createElement(De,{label:"All Firefox Failures",failsIn:["firefox"],passesIn:[],runs:this.state.wptRuns,paths:Array.from(this.state.selectedPaths),geckoMetadata:this.state.pathMetadata,onError:this.onError,filter:this.state.filterFunc},r.a.createElement("h2",null,"All Firefox Failures"),r.a.createElement("p",null,"Tests that fail in Firefox")),r.a.createElement(Fe,{label:"Gecko Data",data:this.state.pathMetadata,paths:Array.from(this.state.selectedPaths),onError:this.onError},r.a.createElement("h2",null,"Gecko metadata"),r.a.createElement("p",null,"Gecko metadata in ",r.a.createElement("code",null,"testing/web-platform/meta")," taken from latest mozilla-central."),r.a.createElement("p",null,"Note: this data is currently not kept up to date"))))),r.a.createElement("div",{id:"app"},r.a.createElement(Ee,{errors:this.state.errors,onDismissError:this.onDismissError}),r.a.createElement("header",null,r.a.createElement("h1",null,"wpt interop dashboard")),t)}}]),t}(n.Component),Ee=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onDismiss=function(e){a.props.onDismissError(e)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.errors.length)return null;var t=[],a=!0,n=!1,s=void 0;try{for(var o,i=function(){var a=o.value,n=(c=Object(m.a)(a,2))[0],s=c[1];t.push(r.a.createElement(xe,{key:"error-".concat(s.id),error:s,onDismiss:function(){return e.onDismiss(n)}}))},l=E(this.props.errors)[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var c;i()}}catch(qe){n=!0,s=qe}finally{try{a||null==l.return||l.return()}finally{if(n)throw s}}return r.a.createElement("ul",{className:"errors"},t)}}]),t}(n.Component),xe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.error,a=t.id,n=t.err,s=t.options,o=[];if(s.retry){o.push(r.a.createElement("button",{onClick:function(){e.props.onDismiss(a),s.retry()},key:"retry"},"Retry"))}return r.a.createElement("li",null,n.message||"Unknown Error",r.a.createElement("button",{onClick:function(){return e.props.onDismiss(a)}},"Close"),o)}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).onInputChange=function(e){a.setState({newSha:e})},a.onEditClick=function(){a.setState({editable:!0})},a.onUpdateClick=function(){a.props.onChange(a.state.newSha),a.setState({editable:!1})},a.state={editable:!1,newSha:null,runShas:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r,s,o,i,c,u,h,p,f,d,v,m,b;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=de("/api/runs",{"max-count":"100"}),e.next=3,me(t);case 3:for(a=e.sent,n=new Map,r=!0,s=!1,o=void 0,e.prev=8,i=a[Symbol.iterator]();!(r=(c=i.next()).done);r=!0)u=c.value,n.has(u.revision)||n.set(u.revision,new Set),n.get(u.revision).add(u.browser_name);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),s=!0,o=e.t0;case 16:e.prev=16,e.prev=17,r||null==i.return||i.return();case 19:if(e.prev=19,!s){e.next=22;break}throw o;case 22:return e.finish(19);case 23:return e.finish(16);case 24:for(h=[],p=!0,f=!1,d=void 0,e.prev=28,v=a[Symbol.iterator]();!(p=(m=v.next()).done);p=!0)b=m.value,n.has(b.revision)&&3===n.get(b.revision).size&&h.push(b.revision),n.delete(b.revision);e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),f=!0,d=e.t1;case 36:e.prev=36,e.prev=37,p||null==v.return||v.return();case 39:if(e.prev=39,!f){e.next=42;break}throw d;case 42:return e.finish(39);case 43:return e.finish(36);case 44:this.setState({runShas:h});case 45:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23],[28,32,36,44],[37,,39,43]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(!this.props.runSha&&!this.state.editable)return null;var e=de("",{sha:this.props.runSha});return r.a.createElement("dl",null,r.a.createElement("dt",null,"wpt SHA1:"),this.state.editable?r.a.createElement("dd",null,this.state.runShas?r.a.createElement("datalist",{id:"runShasData"},this.state.runShas.map(function(e){return r.a.createElement("option",{key:e,value:e})})):null,r.a.createElement(le,{defaultValue:this.props.runSha,onChange:this.onInputChange,list:"runShasData"}),r.a.createElement("button",{onClick:this.onUpdateClick},"Update")):r.a.createElement("dd",null,r.a.createElement("a",{href:e},this.props.runSha.slice(0,12)),r.a.createElement("button",{onClick:this.onEditClick},"Edit")))}}]),t}(n.Component),Se=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.onComponentChange(e)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.components.map(function(e){return{value:e.toLowerCase(),name:e}});return this.props.value?r.a.createElement("section",null,r.a.createElement("label",null,"Bug Component: "),r.a.createElement(ce,{onChange:this.handleChange,value:this.props.value,options:e})):null}}]),t}(n.Component),Me=function(e){function t(e){var a;Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).types=new Map(Object.entries({none:{name:"None",filter:null},untriaged:{name:"Untriaged",filter:"not has _geckoMetadata.bug"},triaged:{name:"Triaged",filter:"has _geckoMetadata.bug"},custom:{name:"Custom\u2026",filter:null}})),a.onTypeChange=function(e){var t;a.types.has(e)&&(a.setState({type:e}),(t="custom"===e?a.state.expr:a.types.get(e).filter)&&a.props.onChange(D(oe(t))))},a.onExprChange=function(e){var t;clearTimeout(a.timer);try{t=e?oe(e):null}catch(n){return void(a.timer=setTimeout(function(){console.log(n)},1e3))}a.timer=setTimeout(function(){var r;try{r=t?D(t):null}catch(n){return void console.error(n)}a.props.onChange(r),a.setState({expr:e})},1e3)};var n=a.getType(),r=Object(m.a)(n,2),s=r[0],o=r[1];return a.state={type:s,expr:o},a.afterFilterUpdate(),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t){t.type===this.state.type&&t.expr===this.state.expr||this.afterFilterUpdate()}},{key:"getType",value:function(){var e="none",t=null,a=we.get("filter");if(a){var n=a.split(":");e=n[0],t=n.slice(1).join(":")}return this.types.has(e)||(e="none",t=null),"custom"!==e&&(t=this.types.get(e).filter),[e,t]}},{key:"afterFilterUpdate",value:function(){var e=this.state.type;if("none"===e)we.delete("filter");else if("custom"===e){var t=this.state.expr;we.set("filter","custom:".concat(t))}else we.set("filter",e)}},{key:"render",value:function(){var e=r.a.createElement("p",{className:"note"},"Triaged status is currently derived from a bug: annotation in the gecko metadata on the test file (not on subtests). In the future this will change to include external annotations accessible to wpt.fyi."),t={triaged:e,untriaged:e,custom:r.a.createElement("div",{className:"note"},r.a.createElement("p",null,"Custom filters are boolean expressions with logical operators \xa0",r.a.createElement("code",null,"and"),", ",r.a.createElement("code",null,"or"),", and ",r.a.createElement("code",null,"not"),"`, equality operators ",r.a.createElement("code",null,"=="),", and ",r.a.createElement("code",null,"!="),"and custom operators ",r.a.createElement("code",null,"in")," for text substrings and ",r.a.createElement("code",null,"has")," for testing if a field exists."),r.a.createElement("p",null,"Available fields are ",r.a.createElement("code",null,"test")," for the test title and",r.a.createElement("code",null,"_geckoMetadata")," for fields set from gecko metadata Gecko metadata fields include ",r.a.createElement("code",null,"bug")," and",r.a.createElement("code",null,"lsan-allowed")),r.a.createElement("p",null,"The ",r.a.createElement("code",null,":")," operator performs a default operation depending on the selected field"),r.a.createElement("p",null,"Examples:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("code",null,"historical in test"),' - The test name contains the substring "historical"'),r.a.createElement("li",null,r.a.createElement("code",null,"test:historical"),' - The test name contains the substring "historical"'),r.a.createElement("li",null,r.a.createElement("code",null,"not has _geckoMetadata.bug")," - Gecko metadata doesn't specify a bug field for the test"),r.a.createElement("li",null,r.a.createElement("code",null,"not has _geckoMetadata.bug")," - Gecko metadata doesn't specify a bug field for the test")))},a=Array.from(this.types).map(function(e){var t=Object(m.a)(e,2);return{value:t[0],name:t[1].name}});return r.a.createElement("section",null,r.a.createElement("label",null,"Filter:"),r.a.createElement(ce,{options:a,value:this.state.type,onChange:this.onTypeChange}),"custom"===this.state.type?r.a.createElement(le,{onChange:this.onExprChange,defaultValue:this.state.expr}):null,t.hasOwnProperty(this.state.type)?t[this.state.type]:null)}}]),t}(n.Component),_e=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).onCheckboxChange=function(e,t){var n=new Set(a.state.paths);t?n.add(e):n.delete(e),a.setState({paths:n})},a.onUpdateClick=function(){a.props.onChange(a.state.paths)},a.state={paths:new Set(a.props.paths)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){e.selectedPaths!==this.props.selectedPaths&&this.setState({paths:new Set(this.props.selectedPaths)})}},{key:"render",value:function(){var e=this;if(!this.props.paths)return null;var t=this.props.paths.sort().map(function(t){return r.a.createElement("li",{key:t},r.a.createElement(ie,{checked:e.props.selectedPaths.has(t),value:t,onCheckboxChange:e.onCheckboxChange}),t)});return r.a.createElement("section",null,r.a.createElement("h2",null,"Test Paths"),r.a.createElement("button",{onClick:this.onUpdateClick,disabled:O(this.state.paths,this.props.selectedPaths)},"Update"),r.a.createElement("ul",{id:"test-paths"},t))}}]),t}(n.Component),De=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={loading_state:fe.NONE,results:[],filter:null,filteredResults:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"buildQuery",value:function(){var e={run_ids:this.props.runs.map(function(e){return e.id}),query:{and:[]}},t=e.query.and,a=!0,n=!1,r=void 0;try{for(var s,o=this.props.failsIn[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var i=s.value,l=!0,c=!1,u=void 0;try{for(var h,p=pe[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var f=h.value;t.push({not:{browser_name:i,status:f}})}}catch(qe){c=!0,u=qe}finally{try{l||null==p.return||p.return()}finally{if(c)throw u}}}}catch(qe){n=!0,r=qe}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}var d=!0,v=!1,m=void 0;try{for(var b,y=this.props.passesIn[Symbol.iterator]();!(d=(b=y.next()).done);d=!0){var g=b.value,k=void 0;if(pe.size>1){var w={or:[]};t.push(w),k=w.or}else k=t;var O=!0,j=!1,E=void 0;try{for(var x,C=pe[Symbol.iterator]();!(O=(x=C.next()).done);O=!0){var S=x.value;k.push({browser_name:g,status:S})}}catch(qe){j=!0,E=qe}finally{try{O||null==C.return||C.return()}finally{if(j)throw E}}}}catch(qe){v=!0,m=qe}finally{try{d||null==y.return||y.return()}finally{if(v)throw m}}return this.props.paths.length>1?t.push({or:this.props.paths.map(function(e){return{pattern:e+"/"}})}):t.push({pattern:this.props.paths[0]}),e}},{key:"fetchResults",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.buildQuery(),e.prev=1,e.next=4,me(de("api/search",{}),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 4:a=e.sent,e.next=12;break;case 7:throw e.prev=7,e.t0=e.catch(1),this.props.onError(e.t0,{retry:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.fetchResults());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}),this.setState({loading_state:fe.COMPLETE}),e.t0;case 12:n=new RegExp(this.props.paths.map(function(e){return"^".concat(e,"/")}).join("|")),a.results=a.results.filter(function(e){return n.test(e.test)}),a.results.forEach(function(e){return e._geckoMetadata=r.getMetadata(e.test)}),this.setState({results:a,loading_state:fe.COMPLETE});case 16:case"end":return e.stop()}},e,this,[[1,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(e){var t=new Map,a=e.split("/"),n=a[a.length-1];a=a.slice(1,a.length-1);var r="";function s(e){for(var a=Object.entries(e),n=0;n<a.length;n++){var r=a[n],s=Object(m.a)(r,2),o=s[0],i=s[1];"_"!==o[0]&&t.set(o,i)}}var o=!0,i=!1,l=void 0;try{for(var c,u=a[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var h=c.value;r.length&&(r+="/"),r+=h;var p=this.props.geckoMetadata[r];p&&s(p)}}catch(qe){i=!0,l=qe}finally{try{o||null==u.return||u.return()}finally{if(i)throw l}}var f=this.props.geckoMetadata[r];if(f&&f._tests&&f._tests[n]){var d=f._tests[n];if(s(d),d._subtests){t._subtests=new Map;for(var v=Object.entries(d._subtests),b=0;b<v.length;b++){var y=v[b],g=Object(m.a)(y,2),k=g[0],w=g[1];t._subtests.set(k,new Map(Object.entries(w)))}}}return t}},{key:"updateFilteredResults",value:function(){var e,t=this;e=this.state.results?this.props.filter?this.state.results.results.filter(function(e){return t.props.filter(e)}):this.state.results.results:this.state.results,this.setState({filteredResults:e})}},{key:"render",value:function(){var e=this;if(this.state.loading_state!==fe.COMPLETE)return r.a.createElement("div",null,this.props.children,r.a.createElement("p",null,"Loading\u2026"));if(null===this.state.results)return r.a.createElement("div",null,this.props.children,r.a.createElement("p",null,"Load failed"));if(!this.state.results.results.length)return r.a.createElement("div",null,this.props.children,r.a.createElement("p",null,"No results"));var t=this.state.filteredResults?this.state.filteredResults:[],a=t.map(function(t){return r.a.createElement(Pe,{failsIn:e.props.failsIn,passesIn:e.props.passesIn,runs:e.props.runs,result:t,key:t.test,geckoMetadata:t.test._geckoMetadata||new Map,onError:e.props.onError})});return a.sort(function(e,t){return e.key>t.key?1:e.key===t.key?0:-1}),r.a.createElement("div",null,this.props.children,r.a.createElement("p",null,t.length," top-level tests with \xa0",t.map(function(e){return e.legacy_status[0].total}).reduce(function(e,t){return e+t},0)," subtests"),r.a.createElement("ul",null,a))}},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchIfPossible({});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(u.a)(l.a.mark(function e(t,a){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchIfPossible(t);case 2:a.filter!==this.state.filter&&this.updateFilteredResults();case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchIfPossible",value:function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.loading_state!==fe.LOADING){e.next=2;break}return e.abrupt("return");case 2:if(null!==this.props.runs){e.next=4;break}return e.abrupt("return");case 4:if(this.props.paths){e.next=6;break}return e.abrupt("return");case 6:if(this.state.loading_state!==fe.COMPLETE||this.props.paths!==t.paths||this.props.failsIn!==t.failsIn||this.props.passesIn!==t.passesIn){e.next=8;break}return e.abrupt("return");case 8:if(this.props.paths.length){e.next=11;break}return this.setState({results:{results:[]},loading_state:fe.COMPLETE}),e.abrupt("return");case 11:return this.setState({results:null,loading_state:fe.LOADING}),e.next=14,this.fetchResults();case 14:this.updateFilteredResults();case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(n.Component),Ae=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleClick=function(){a.setState({showDetails:!a.state.showDetails})},a.state={showDetails:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("li",{className:"tree-row"+(this.state.showDetails?" tree-row-expanded":"")},r.a.createElement("span",{onClick:this.handleClick},this.state.showDetails?"\u25bc ":"\u25b6 ",this.props.rowTitle),this.props.rowExtra,this.state.showDetails?r.a.createElement("div",{className:"tree-row"},this.props.children):"")}}]),t}(n.Component),Pe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e="".concat(this.props.result.test," [").concat(this.props.result.legacy_status[0].total," subtests]");return r.a.createElement(Ae,{rowTitle:r.a.createElement("code",null,e),rowExtra:null},r.a.createElement(Te,{runs:this.props.runs,test:this.props.result.test,passesIn:this.props.passesIn,failsIn:this.props.failsIn,geckoMetadata:this.props.geckoMetadata,onError:this.props.onError}))}}]),t}(n.Component),Te=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={loaded:!1,results:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"processResultData",value:function(e){var t=this,a=new Map,n=!0,r=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var l=o.value,c=Object(m.a)(l,2),u=c[0],h=c[1];a.has(null)||a.set(null,new Map),a.get(null).set(u,{status:h.status,message:h.message});var p=!0,f=!1,d=void 0;try{for(var v,b=h.subtests[Symbol.iterator]();!(p=(v=b.next()).done);p=!0){var y=v.value;a.has(y.name)||a.set(y.name,new Map),a.get(y.name).set(u,{status:y.status,message:y.message})}}catch(qe){f=!0,d=qe}finally{try{p||null==b.return||b.return()}finally{if(f)throw d}}}}catch(qe){r=!0,s=qe}finally{try{n||null==i.return||i.return()}finally{if(r)throw s}}var g=!0,k=!1,w=void 0;try{for(var O,j=a.values()[Symbol.iterator]();!(g=(O=j.next()).done);g=!0){var E=O.value,x=!0,C=!1,S=void 0;try{for(var M,_=this.props.runs[Symbol.iterator]();!(x=(M=_.next()).done);x=!0){var D=M.value.browser_name;E.has(D)||E.set(D,{status:"MISSING",message:null})}}catch(qe){C=!0,S=qe}finally{try{x||null==_.return||_.return()}finally{if(C)throw S}}}}catch(qe){k=!0,w=qe}finally{try{g||null==j.return||j.return()}finally{if(k)throw w}}var A=new Map,P=!0,T=!1,I=void 0;try{for(var R,N=function(){var e=R.value,a=(F=Object(m.a)(e,2))[0],n=F[1];t.props.passesIn.every(function(e){return pe.has(n.get(e).status)})&&t.props.failsIn.every(function(e){return!pe.has(n.get(e).status)})&&A.set(a,n)},L=a[Symbol.iterator]();!(P=(R=L.next()).done);P=!0){var F;N()}}catch(qe){T=!0,I=qe}finally{try{P||null==L.return||L.return()}finally{if(T)throw I}}var G=[];return A.has(null)&&(G.push([null,A.get(null)]),A.delete(null)),G.concat(Array.from(A))}},{key:"fetchData",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,r,s,o,i,c,u,h,p,f,d,v,b,y,g,k,w,O,j,x,C,S,M,_;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new Map,a=[],n=[],r=!0,s=!1,o=void 0,e.prev=6,i=this.props.runs[Symbol.iterator]();!(r=(c=i.next()).done);r=!0)u=c.value,h=u.browser_name,p=u.results_url,(f=p.split("-")).pop(),d="".concat(f.join("-")).concat(this.props.test),v=me(d).then(function(e){return{success:!0,value:e}}).catch(function(e){return{success:!1,value:e}}),a.push(h),n.push(v);e.next=14;break;case 10:e.prev=10,e.t0=e.catch(6),s=!0,o=e.t0;case 14:e.prev=14,e.prev=15,r||null==i.return||i.return();case 17:if(e.prev=17,!s){e.next=20;break}throw o;case 20:return e.finish(17);case 21:return e.finish(14);case 22:return e.next=24,Promise.all(n);case 24:for(b=e.sent,y=!0,g=!1,k=void 0,e.prev=28,w=E(b)[Symbol.iterator]();!(y=(O=w.next()).done);y=!0)j=O.value,x=Object(m.a)(j,2),C=x[0],(S=x[1]).success&&(M=a[C],t.set(M,S.value));e.next=36;break;case 32:e.prev=32,e.t1=e.catch(28),g=!0,k=e.t1;case 36:e.prev=36,e.prev=37,y||null==w.return||w.return();case 39:if(e.prev=39,!g){e.next=42;break}throw k;case 42:return e.finish(39);case 43:return e.finish(36);case 44:_=this.processResultData(t),this.setState({results:_,loaded:!0});case 46:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21],[28,32,36,44],[37,,39,43]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchData();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;if(!this.state.loaded)return r.a.createElement("p",null,"Loading");var t=this.props.runs.map(function(e){return r.a.createElement("th",{key:e.browser_name},e.browser_name)});t.push(r.a.createElement("th",{key:"metadata"}));var a=this.props.geckoMetadata.get("_subtests")||new Map,n=this.state.results.map(function(t){var n=Object(m.a)(t,2),s=n[0],o=n[1];return r.a.createElement(Ne,{key:s,runs:e.props.runs,subtest:s,results:o,geckoMetadata:a.get(s)})});return r.a.createElement("div",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"http://w3c-test.org".concat(this.props.test)},"Live test")),r.a.createElement("li",null,r.a.createElement("a",{href:de("results/".concat(this.props.test))},"wpt.fyi")),r.a.createElement("li",null,r.a.createElement("a",{href:"http://searchfox.org/mozilla-central/source/testing/web-platform/meta".concat(ke(this.props.test),".ini")},"Gecko Metadata"))),r.a.createElement(Ie,{test:this.props.test,data:this.props.geckoMetadata}),r.a.createElement("section",null,r.a.createElement("h3",null,"Results"),r.a.createElement("table",{className:"results"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),t)),r.a.createElement("tbody",null,n))))}}]),t}(n.Component),Ie=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this,a=function(e){return r.a.createElement(Ue,{value:e})};this.props.data?e=[{name:"disabled",render:a},{name:"bug",render:a},{name:"crash",title:"Crashes",render:a}].map(function(e){return t.props.data.has(e.name)?r.a.createElement(Re,{key:e.name,title:e.title?e.title:(a=e.name,a&&a[0].toUpperCase()+a.slice(1)),values:t.props.data.get(e.name),render:e.render}):null;var a}).filter(function(e){return null!==e}):e=[];return 0===e.length?null:r.a.createElement("section",null,r.a.createElement("h3",null,"Gecko Metadata"),r.a.createElement("ul",null,e))}}]),t}(n.Component),Re=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.values?1===this.props.values.length&&null===this.props.values[0][0]?r.a.createElement("li",null,this.props.title,": ",this.props.render(this.props.values[0])):r.a.createElement(Ge,{title:this.props.title,values:this.props.values,render:this.props.render}):null}}]),t}(n.Component),Ne=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.runs.map(function(t){var a=e.props.results.get(t.browser_name);return r.a.createElement(Le,{result:a,key:t.browser_name})});return t.push(r.a.createElement("td",{key:"metadata"},r.a.createElement(Ie,{data:this.props.geckoMetadata}))),r.a.createElement("tr",null,r.a.createElement("th",null,this.props.subtest?this.props.subtest:"<parent>"),t)}}]),t}(n.Component),Le=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("td",{className:"result result-".concat(this.props.result.status.toLowerCase()),title:this.props.result.message},this.props.result.status)}}]),t}(n.Component),Fe=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"groupData",value:function(){for(var e=new Map,t=new Map,a=new Map,n=Object.entries(this.props.data),r=0;r<n.length;r++){var s=n[r],o=Object(m.a)(s,2),i=o[0],l=o[1];if(l.disabled&&e.set(i,l.disabled),l["lsan-allowed"]&&t.set(i,l["lsan-allowed"]),l.expected_CRASH&&a.set(i,l.expected_CRASH.map(function(e){return[e,null]})),l._tests)for(var c=Object.entries(l._tests),u=0;u<c.length;u++){var h=c[u],p=Object(m.a)(h,2),f=p[0],d=p[1],v="".concat(i,"/").concat(f);if(d.disabled&&e.set(v,d.disabled),d.expected_CRASH&&a.set(v,d.expected_CRASH.map(function(e){return[e,null]})),d._subtests)for(var b=Object.entries(d._subtests),y=0;y<b.length;y++){var g=b[y],k=Object(m.a)(g,2),w=k[0],O=k[1],j="".concat(i,"/").concat(f," | ").concat(w);O.disabled&&e.set(j,O.disabled),O.expected_CRASH&&a.set(j,O.expected_CRASH.map(function(e){return[e,null]}))}}}return{disabled:e,lsan:t,crashes:a}}},{key:"render",value:function(){var e;if(null!==this.props.data){e=[];var t=this.groupData();if(t.crashes){var a=[],n=!0,s=!1,o=void 0;try{for(var i,l=j(t.crashes)[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var c=i.value,u=Object(m.a)(c,2),h=u[0],p=u[1];a.push(r.a.createElement(Ge,{key:h,title:h,values:p,render:function(e){return null}}))}}catch(qe){s=!0,o=qe}finally{try{n||null==l.return||l.return()}finally{if(s)throw o}}a.length&&e.push(r.a.createElement("section",{key:"crashes"},r.a.createElement("h2",null,"Crashes"),r.a.createElement("p",null,a.length," tests crash in some configurations"),r.a.createElement("ul",null,a)))}if(t.disabled){var f=[],d=!0,v=!1,b=void 0;try{for(var y,g=j(t.disabled)[Symbol.iterator]();!(d=(y=g.next()).done);d=!0){var k=y.value,w=Object(m.a)(k,2),O=w[0],E=w[1];f.push(r.a.createElement(Ge,{key:O,title:O,values:E,render:function(e){return r.a.createElement(Ue,{value:e})}}))}}catch(qe){v=!0,b=qe}finally{try{d||null==g.return||g.return()}finally{if(v)throw b}}f.length&&e.push(r.a.createElement("section",{key:"disabled"},r.a.createElement("h2",null,"Disabled"),r.a.createElement("p",null,f.length," tests are disabled in some configurations"),r.a.createElement("ul",null,f)))}if(t.lsan){var x=[],C=!0,S=!1,M=void 0;try{for(var _,D=j(t.lsan)[Symbol.iterator]();!(C=(_=D.next()).done);C=!0){var A=_.value,P=Object(m.a)(A,2),T=P[0],I=P[1];x.push(r.a.createElement(Ge,{key:T,title:T,values:I,render:function(e){return r.a.createElement(ze,{value:e})}}))}}catch(qe){S=!0,M=qe}finally{try{C||null==D.return||D.return()}finally{if(S)throw M}}x.length&&e.push(r.a.createElement("section",{key:"lsan"},r.a.createElement("h2",null,"LSAN Failures"),r.a.createElement("p",null,x.length," directories have LSAN failures"),r.a.createElement("ul",null,x)))}return r.a.createElement("section",null,this.props.children,e.length?e:r.a.createElement("p",null,"No metadata available"))}return e=r.a.createElement("p",null,"Loading"),r.a.createElement("section",null,r.a.createElement("h2",null,"Gecko metadata"),r.a.createElement("p",null,"None"))}}]),t}(n.Component),Ge=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=[],t=!0,a=!1,n=void 0;try{for(var s,o=this.props.values[Symbol.iterator]();!(t=(s=o.next()).done);t=!0){var i=s.value,l=Object(m.a)(i,2),c=l[0],u=l[1],h=c?"if ".concat(c).concat(u?": ":" "):"";e.push(r.a.createElement("li",{key:c||"None"},r.a.createElement("code",null,h),u?this.props.render(u):null))}}catch(qe){a=!0,n=qe}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}var p=null;return e.length&&(p=r.a.createElement("ul",{className:"tree-row"},e)),r.a.createElement(Ae,{rowTitle:this.props.title,rowExtra:null},p)}}]),t}(n.Component),Ue=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=[/https?:\/\/bugzilla\.mozilla\.org\/show_bug\.cgi\?id=(\d+)/,/(?:bug\s+)?(\d+)/i],t=0;t<e.length;t++){var a=e[t].exec(this.props.value);if(null!==a)return r.a.createElement("a",{href:"https://bugzilla.mozilla.org/show_bug.cgi?id=".concat(a[1])},"Bug ",a[1])}return this.props.value}}]),t}(n.Component),ze=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(Array.isArray(this.props.value)){var e=this.props.value.map(function(e){return r.a.createElement("li",{key:e},r.a.createElement("code",null,e))});return r.a.createElement("ul",null,e)}return this.props.value}}]),t}(n.Component),Be=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).handleClickTab=function(e){a.setState({activeTab:e}),we.set("tab",e)},a.state={activeTab:we.get("tab")||a.props.children[0].props.label},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.children.map(function(t){var a=t.props.label;return r.a.createElement(He,{active:e.state.activeTab===a,label:a,key:a,onClick:e.handleClickTab})}),a=this.props.children.find(function(t){return t.props.label===e.state.activeTab});return r.a.createElement("div",{className:"tab-view"},r.a.createElement("ol",{className:"tab-strip"},t),r.a.createElement("div",{className:"tab-content"},a))}}]),t}(n.Component),He=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(){a.props.onClick(a.props.label)},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("li",{className:"tab-label "+(this.props.active?"tab-active":""),onClick:this.onClick},this.props.label)}}]),t}(n.Component),We=je;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(We,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[13,2,1]]]);
//# sourceMappingURL=main.f385ade6.chunk.js.map